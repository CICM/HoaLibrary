max v2;#N vpatcher 431 71 1059 822;#P window setfont "Sans Serif" 9.;#P newex 80 447 48 196617 loadbang;#P newex 471 89 48 196617 loadbang;#P newex 144 110 48 196617 loadbang;#P toggle 125 110 15 0;#P hidden newex 174 277 66 196617 loadmess 20;#P window linecount 2;#P comment 132 251 79 196617 amount of doppler shift:;#P flonum 133 279 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P window linecount 1;#N vpatcher 94 477 392 791;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P comment 44 199 79 196617 variable delay;#P comment 162 179 60 196617 smoothing;#P comment 134 61 60 196617 amount;#P comment 88 61 60 196617 distance;#P window linecount 0;#P newex 112 203 97 196617 slide~ 4410. 4410.;#P inlet 137 78 15 0;#P window linecount 1;#P newex 112 103 27 196617 + 1.;#P newex 112 129 35 196617 * 10.;#P newex 112 152 57 196617 pack 0. 50;#P newex 112 177 47 196617 line~ 10;#P newex 36 233 59 196617 tapout~ 10;#P window linecount 0;#P newex 36 103 65 196617 tapin~ 1000;#P inlet 90 76 15 0;#P inlet 36 77 15 0;#P outlet 36 257 15 0;#P comment 35 61 60 196617 source;#P connect 2 0 4 0;#P connect 4 0 5 0;#P fasten 11 0 5 0 117 226 41 226;#P connect 5 0 1 0;#P fasten 3 0 9 0 95 97 117 97;#P connect 9 0 8 0;#P connect 8 0 7 0;#P connect 7 0 6 0;#P connect 6 0 11 0;#P connect 10 0 8 1;#P pop;#P newobj 41 300 103 196617 p doppler_simulation;#P window linecount 4;#P comment 315 446 97 196617 simulate two reverberant walls \; one to the left and one to the right:;#P window linecount 1;#P newex 315 497 48 196617 loadbang;#P newex 295 551 155 196617 ambi.encoden~ 2d 2nd degrees 2;#N vpatcher 10 59 212 227;#P window setfont "Sans Serif" 9.;#N counter 1 360;#X flags 0 0;#P newobj 50 69 74 196617 counter 1 360;#P newex 50 50 52 196617 metro 20;#P inlet 50 30 15 0;#P outlet 50 91 15 0;#P connect 1 0 2 0;#P connect 2 0 3 0;#P connect 3 0 0 0;#P pop;#P newobj 62 470 37 196617 p auto;#N vpatcher 10 59 312 428;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 121 139 32 196617 *~ 2;#P newex 121 166 55 196617 snapshot~;#P newex 121 113 68 196617 pong~ 1 -1 1;#P newex 121 92 32 196617 *~ 2;#P window linecount 0;#P newex 121 66 64 196617 cycle~ 0.04;#P window linecount 1;#P newex 121 191 35 196617 * 4.;#P window linecount 0;#P newex 50 50 52 196617 metro 20;#P inlet 50 30 15 0;#P outlet 69 249 15 0;#P connect 1 0 2 0;#P connect 3 0 0 0;#P connect 4 0 5 0;#P connect 5 0 6 0;#P connect 6 0 8 0;#P connect 2 0 7 0;#P connect 8 0 7 0;#P connect 7 0 3 0;#P connect 6 0 8 1;#P pop;#P newobj 453 111 37 196617 p auto;#N vpatcher 191 292 430 549;#P window setfont "Sans Serif" 9.;#P comment 129 56 42 196617 falloff;#P comment 84 56 42 196617 distance;#P outlet 86 202 14 0;#N vpatcher 17 62 801 783;#P button 86 36 15 0;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 118 59 67 196617 unpack 0 0 0;#P newex 118 32 96 196617 loadmess 45 50 90;#P window linecount 2;#P comment 453 70 28 196617 yafr -2up;#B color 7;#P user hslider 239 120 18 128 128 1 0 8;#P comment 384 118 75 196617 high frequency rolloff;#B color 12;#P user hslider 239 92 18 128 128 1 0 8;#P comment 384 87 92 196617 reverb/early reflections balance;#B color 12;#P user hslider 239 66 18 128 128 1 0 8;#P window linecount 1;#P comment 384 66 60 196617 reverb time;#B color 12;#P message 700 262 50 196617 1.16;#P newex 700 240 50 196617 loadbang;#P window linecount 4;#P comment 468 273 168 196617 LFO perturbs times of allpass tail to reduce metallic-sounding echoes. to lessen CPU usage \, we do this as floats rather than signals.;#P window linecount 2;#P comment 159 233 118 196617 magic numbers for early reflection times.;#P window linecount 1;#P comment 168 543 73 196617 early ref. mix;#P window linecount 2;#P comment 411 532 73 196617 reverb tail: series allpass.;#P window linecount 1;#P comment 84 652 158 196617 uncorrelators make stereo effect;#P newex 603 506 28 196617 !- 0.;#P newex 603 465 27 196617 + 0.;#P window linecount 2;#P comment 39 440 93 196617 early refs: allpass in feedback.;#P window linecount 1;#P newex 396 326 160 196617 expr cos($f1* .06283185) * 0.3;#N counter 100;#X flags 0 0;#P newobj 396 305 66 196617 counter 100;#P newex 604 418 28 196617 !- 0.;#P newex 264 621 60 196617 tapout~ 10.;#P newex 264 601 54 196617 tapin~ 10.;#P newex 264 582 39 196617 *~ 0.2;#P newex 604 377 27 196617 + 0.;#P newex 396 263 45 196617 loadbang;#P newex 396 284 50 196617 metro 10;#P newex 137 506 105 196617 expr (1. - $f1) * 0.5;#P newex 137 482 92 196617 zmap 0. 127. 0. 1.;#P newex 49 540 27 196617 *~;#P newex 19 540 27 196617 *~;#P newex 230 270 33 196617 * 30.;#P newex 194 270 33 196617 * 76.;#P newex 152 270 39 196617 * 122.;#P newex 152 200 98 196617 zmap 0. 127. 0. 1.;#P newex 19 385 92 196617 onepole~ 1800 Hz.;#P newex 178 571 39 196617 * 0.85;#P newex 132 592 102 196617 allpass~ 200 0. 0.38;#P newex 674 323 20 196617 t b;#P flonum 700 282 45 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 511 547 80 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 510 506 80 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 511 462 80 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 509 418 80 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 635 486 27 196617 * 1.;#P newex 635 443 27 196617 * 1.;#P newex 635 398 27 196617 * 1.;#P newex 635 354 27 196617 * 1.;#P flonum 382 228 80 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 19 228 92 196617 onepole~ 1800 Hz.;#P newex 19 335 95 196617 allpass~ 80 50. 0.2;#P newex 19 359 95 196617 allpass~ 80 50. 0.2;#P newex 255 200 122 196617 zmap 0. 127. 200. 8000.;#P newex 19 592 102 196617 allpass~ 200 0. 0.35;#P newex 375 502 108 196617 allpass~ 200 0. 0.63;#P newex 375 443 108 196617 allpass~ 200 0. 0.72;#P newex 375 414 108 196617 allpass~ 200 0. 0.75;#P newex 19 409 45 196617 *~ -0.3;#P newex 19 311 65 196617 tapout~ 130.;#P newex 19 287 60 196617 tapin~ 130.;#N comlet out R;#P outlet 51 650 15 0;#P newex 382 200 101 196617 zmap 0. 127. 1. 76;#P newex 375 474 108 196617 allpass~ 200 0. 0.662;#N comlet out L;#P outlet 19 650 15 0;#N comlet signal in;#P inlet 19 171 15 0;#P comment 276 653 64 196617 feedback tap;#P user panel 254 569 91 102;#X brgb 181 255 178;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 370 406 119 157;#X brgb 181 255 178;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 15 271 124 201;#X brgb 181 255 178;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 15 569 233 102;#X brgb 181 255 178;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 15 477 233 83;#X brgb 181 255 178;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P window linecount 4;#P comment 369 570 301 196617 allpass times are generated by successive multiplication by a magic number. LFO is both added and subtracted from times so total time remains constant. this reduces pitch-shift artifacts from the modulation.;#P window linecount 2;#P comment 606 647 118 196617 yet another free reverb. -2up;#P user panel 225 52 273 106;#X brgb 181 255 178;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P connect 9 0 24 0;#P fasten 16 0 14 0 24 432 130 432 130 279 24 279;#P connect 24 0 14 0;#P connect 14 0 15 0;#P fasten 40 0 15 0 157 307 24 307;#P connect 15 0 23 0;#P connect 23 0 22 0;#P connect 22 0 38 0;#P connect 38 0 16 0;#P fasten 16 0 43 0 24 485 24 485;#P connect 44 0 20 0;#P connect 43 0 20 0;#P connect 20 0 10 0;#P fasten 45 0 43 1 142 502 41 502;#P fasten 19 0 44 0 380 529 54 529;#P fasten 36 0 13 0 137 622 56 622;#P fasten 41 0 23 1 199 331 66 331;#P fasten 42 0 22 1 235 355 66 355;#P fasten 25 0 20 1 387 397 336 397 336 563 70 563;#P fasten 46 0 44 1 142 537 71 537;#P fasten 21 0 24 1 260 221 106 221;#P fasten 21 0 38 1 260 223 147 223 147 383 106 383;#P connect 75 0 73 0;#P connect 73 0 74 0;#P connect 43 0 36 0;#P connect 44 0 36 0;#P hidden fasten 69 0 45 0 244 115 142 115;#P connect 45 0 46 0;#P hidden fasten 67 0 39 0 244 87 157 87;#P connect 39 0 40 0;#P fasten 25 0 37 0 387 397 340 397 340 566 183 566;#P connect 37 0 36 1;#P fasten 39 0 41 0 157 264 199 264;#P fasten 39 0 42 0 157 264 235 264;#P connect 74 0 67 0;#P connect 74 1 69 0;#P connect 74 2 71 0;#P hidden connect 71 0 21 0;#P fasten 36 0 50 0 137 615 238 615 238 574 269 574;#P fasten 20 0 50 0 24 619 238 619 238 577 269 577;#P connect 50 0 51 0;#P connect 51 0 52 0;#P fasten 16 0 17 0 24 431 299 431 299 355 380 355;#P fasten 52 0 17 0 269 640 332 640 332 371 380 371;#P fasten 24 0 17 0 24 259 380 259;#P connect 17 0 18 0;#P connect 18 0 11 0;#P connect 11 0 19 0;#P hidden connect 67 0 12 0;#P connect 12 0 25 0;#P connect 48 0 47 0;#P connect 47 0 54 0;#P connect 54 0 55 0;#P fasten 33 0 17 1 516 569 500 569 500 409 429 409;#P fasten 32 0 18 1 515 526 497 526 497 438 429 438;#P fasten 31 0 11 1 516 483 495 483 495 468 429 468;#P fasten 30 0 19 1 514 440 492 440 492 496 429 496;#P connect 49 0 30 0;#P connect 57 0 32 0;#P connect 53 0 31 0;#P connect 58 0 33 0;#P fasten 55 0 57 0 401 352 598 352 598 458 608 458;#P fasten 55 0 58 0 401 351 598 351 598 500 608 500;#P fasten 55 0 49 0 401 350 599 350 599 374 609 374;#P fasten 55 0 53 0 401 350 598 350 598 413 609 413;#P connect 28 0 57 1;#P connect 26 0 49 1;#P connect 29 0 58 1;#P connect 27 0 53 1;#P fasten 25 0 26 0 387 384 581 384 581 341 640 341;#P fasten 35 0 26 0 679 348 640 348;#P connect 26 0 27 0;#P connect 27 0 28 0;#P connect 28 0 29 0;#P fasten 34 0 26 1 705 351 657 351;#P fasten 34 0 27 1 705 393 657 393;#P fasten 34 0 28 1 705 438 657 438;#P fasten 34 0 29 1 705 482 657 482;#P connect 34 0 35 0;#P connect 64 0 65 0;#P connect 65 0 34 0;#P pop;#P newobj 47 176 49 196617 p reverb;#P inlet 47 77 15 0;#P newex 47 146 35 196617 *~ 1.;#P newex 72 97 71 196617 maximum 1.;#P newex 72 123 80 196617 expr ($f2/$f1);#P inlet 84 76 16 0;#P inlet 133 74 15 0;#P outlet 47 202 14 0;#P comment 45 56 42 196617 source;#P connect 7 0 6 0;#P connect 6 0 8 0;#P connect 8 0 1 0;#P connect 3 0 5 0;#P connect 5 0 4 0;#P connect 4 0 6 1;#P connect 8 1 9 0;#P connect 2 0 5 1;#P fasten 2 0 4 1 138 93 147 93;#P pop;#P newobj 295 393 155 196617 p reverb_by_distance;#P hidden newex 479 362 60 196617 loadmess 4;#P flonum 439 363 35 9 0.01 0 1 3 0 0 0 221 221 221 222 222 222 0 0 0;#P window linecount 2;#P comment 439 335 81 196617 radius of reverb falloff:;#P toggle 453 89 15 0;#P window linecount 1;#P message 418 670 27 196617 stop;#P message 348 670 65 196617 startwindow;#P user panel 340 663 113 30;#X brgb 255 255 255;#X frgb 100 202 30;#X border 2;#X rounded 0;#X shadow 0;#X done;#P flonum 395 609 35 9 0. 1. 3 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 348 608 35 9 0. 0 1 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 395 631 50 196617 width \$1;#P message 348 631 43 196617 gain \$1;#P flonum 171 493 35 9 -360. 360. 3 3 0 0 0 221 221 221 222 222 222 0 0 0;#P toggle 41 110 15 0;#P window setfont Arial 12.;#N vpatcher 108 359 551 660;#P origin 10 -39;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 279 93 67 196617 cycle~ 1760;#P newex 211 92 61 196617 cycle~ 440;#P inlet 315 35 15 0;#P window linecount 0;#P newex 315 59 35 196617 * 0.1;#P window linecount 1;#P newex 203 169 39 196617 *~ 0.2;#P newex 275 136 66 196617 phasor~ -10;#P newex 203 143 39 196617 *~ 0.2;#P newex 198 112 61 196617 cycle~ 880;#P window linecount 0;#P newex 153 49 105 196617 info~ cherokee.aif;#P comment 95 71 105 196617 sound playback on/off;#N comlet sound playback L;#P outlet 18 226 15 0;#P message 76 118 27 196617 stop;#P message 109 118 83 196617 loop 1 \, startloop;#P newex 76 90 43 196617 sel 0;#P newex 18 117 35 196617 sig~ 1;#P newex 18 143 139 196617 groove~ sound 2;#P newex 12 25 153 196617 buffer~ sound cherokee.aif -1 2;#N comlet soundfile on/off;#P inlet 76 69 15 0;#P connect 3 0 2 0;#P fasten 6 0 2 0 81 138 23 138;#P fasten 5 0 2 0 114 138 23 138;#P fasten 13 0 7 0 208 218 23 218;#P connect 2 0 7 0;#P fasten 2 1 7 0 87 193 23 193;#P connect 0 0 4 0;#P connect 4 0 6 0;#P connect 4 1 5 0;#P fasten 9 6 2 2 236 135 151 135;#P connect 1 1 9 0;#P connect 10 0 11 0;#P connect 16 0 11 0;#P connect 17 0 11 0;#P connect 11 0 13 0;#P connect 14 0 11 1;#P connect 12 0 13 1;#P connect 15 0 14 0;#P pop;#P newobj 41 135 94 131137548 p drums+sines;#P toggle 62 448 15 0;#P window setfont "Sans Serif" 9.;#P comment 453 396 97 196617 reverberation;#N vpatcher 10 59 278 375;#P window setfont "Sans Serif" 9.;#P newex 165 54 48 196617 loadbang;#P newex 132 140 31 196617 !/ 1.;#P newex 127 164 47 196617 sig~ 0.5;#P newex 165 106 34 196617 / 2.1;#P newex 62 164 62 196617 sig~ 22050;#P newex 62 140 55 196617 !/ 22050.;#P newex 62 85 71 196617 maximum 1.;#P newex 62 107 80 196617 expr ($f1/$f2);#P newex 165 80 61 196617 adstatus sr;#P newex 32 234 79 196617 biquad~;#P newex 63 189 106 196617 filtercoeff~ highshelf;#P inlet 132 57 15 0;#P inlet 62 65 15 0;#P inlet 32 214 15 0;#P outlet 62 162 15 0;#P outlet 32 256 15 0;#P connect 2 0 6 0;#P connect 6 0 0 0;#P connect 5 0 6 1;#P connect 5 1 6 2;#P connect 3 0 9 0;#P connect 9 0 8 0;#P connect 8 0 10 0;#P connect 10 0 1 0;#P connect 10 0 11 0;#P connect 11 0 5 0;#P connect 5 2 6 3;#P connect 5 3 6 4;#P connect 5 4 6 5;#P fasten 12 0 10 1 170 130 112 130;#P connect 13 0 5 1;#P connect 4 0 9 1;#P connect 4 0 8 1;#P fasten 8 0 14 0 67 132 137 132;#P connect 15 0 7 0;#P fasten 7 1 12 0 221 101 170 101;#P pop;#P newobj 41 209 114 196617 p lowpass_by_distance;#N vpatcher 191 292 430 549;#P inlet 21 131 15 0;#P window setfont "Sans Serif" 9.;#P newex 21 160 35 196617 *~ 1.;#P outlet 58 126 15 0;#P newex 46 50 71 196617 maximum 1.;#P newex 46 76 80 196617 expr ($f2/$f1);#P inlet 46 30 15 0;#P inlet 116 28 15 0;#P outlet 21 199 14 0;#P connect 7 0 6 0;#P connect 6 0 0 0;#P connect 2 0 4 0;#P connect 4 0 3 0;#P connect 3 0 6 1;#P connect 3 0 5 0;#P connect 1 0 4 1;#P connect 1 0 3 1;#P pop;#P newobj 41 394 116 196617 p amplitude_by_distance;#P hidden newex 188 370 60 196617 loadmess 1;#P hidden newex 185 176 75 196617 loadmess 0.25;#P newex 41 695 140 196617 dac~ 1 2 3 4 5 6 7 8;#P newex 41 652 141 196617 ambi.decode~ 2d 2nd 8;#P window linecount 3;#P comment 324 32 201 196617 An example of using Max/MSP objects to simulate distance cues for spatial audio in combination with Ambisonic spatialization.;#P window linecount 1;#P comment 16 69 300 196617 www.grahamwakefield.net;#P comment 16 57 300 196617 Graham Wakefield \, 2006;#P window setfont "Sans Serif" 20.;#P comment 16 28 301 196628 Ambisonic Distance Cues;#P window setfont "Sans Serif" 9.;#P flonum 145 176 35 9 0.01 0 1 3 0 0 0 221 221 221 222 222 222 0 0 0;#P window linecount 2;#P comment 145 148 66 196617 rate of filter falloff:;#P window linecount 1;#P newex 367 168 37 196617 abs 0.;#P flonum 147 369 35 9 0.01 0 1 3 0 0 0 221 221 221 222 222 222 0 0 0;#P window linecount 2;#P comment 147 340 66 196617 radius of 6db falloff:;#P window linecount 1;#P newex 171 515 29 196617 sig~;#P newex 106 514 29 196617 sig~;#P flonum 106 493 35 9 -360. 360. 3 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 367 143 35 9 -16. 16. 3 3 0 0 0 40 204 140 222 222 222 0 0 0;#P window linecount 2;#P comment 171 461 61 196617 Elevation (theta):;#P comment 106 461 43 196617 Azimuth (phi):;#P window linecount 1;#P newex 41 553 141 196617 ambi.encode~ 2d 2nd degrees;#P comment 366 119 79 196617 Distance (r):;#P message 315 518 91 196617 azimuths -90. 90.;#P connect 27 0 26 0;#P connect 26 0 23 0;#P connect 23 0 46 0;#P connect 46 0 22 0;#P connect 22 0 2 0;#P fasten 29 0 18 0 353 647 46 647;#P fasten 30 0 18 0 400 647 46 647;#P connect 2 0 18 0;#P fasten 43 0 18 0 300 587 46 587;#P fasten 35 0 19 0 423 690 46 690;#P fasten 34 0 19 0 353 690 46 690;#P connect 18 0 19 0;#P connect 18 1 19 1;#P hidden connect 53 0 25 0;#P connect 25 0 42 0;#P connect 2 1 18 1;#P fasten 43 1 18 1 336 587 78 587;#P connect 18 2 19 2;#P fasten 11 0 46 1 372 241 92 241;#P lcolor 7;#P fasten 11 0 23 1 372 199 98 199;#P lcolor 7;#P fasten 11 0 22 1 372 333 99 333;#P lcolor 7;#P connect 18 3 19 3;#P connect 2 2 18 2;#P fasten 43 2 18 2 372 587 110 587;#P fasten 42 0 6 0 67 492 111 492;#P connect 6 0 7 0;#P connect 7 0 2 1;#P connect 18 4 19 4;#P hidden connect 51 0 50 0;#P connect 50 0 26 1;#P connect 18 5 19 5;#P hidden connect 49 0 47 0;#P connect 47 0 46 2;#P connect 2 3 18 3;#P fasten 43 3 18 3 408 587 142 587;#P hidden connect 20 0 13 0;#P fasten 13 0 23 2 150 204 150 204;#P hidden connect 21 0 10 0;#P connect 10 0 22 2;#P connect 18 6 19 6;#P connect 18 7 19 7;#P connect 2 4 18 4;#P fasten 43 4 18 4 444 587 174 587;#P connect 28 0 8 0;#P connect 8 0 2 2;#P fasten 46 0 40 0 46 325 300 325;#P connect 40 0 43 0;#P connect 0 0 43 0;#P connect 44 0 0 0;#P connect 31 0 29 0;#P fasten 41 0 5 0 458 137 372 137;#P connect 5 0 11 0;#P fasten 11 0 40 1 372 199 372 199;#P lcolor 7;#P connect 32 0 30 0;#P hidden connect 39 0 38 0;#P connect 38 0 40 2;#P connect 40 1 43 1;#P hidden connect 52 0 36 0;#P connect 36 0 41 0;#P pop;